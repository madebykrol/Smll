<!DOCTYPE HTML>
<html>
<head>
  <title>Smll framework</title>
  <link href="./assets/bootstrap/css/bootstrap.css" rel="stylesheet">
  <link href="./assets/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
  <link href="./assets/prettify.css" rel="stylesheet">
  <link href="./assets/main.css" rel="stylesheet">
</head>
<body>
  <div class="navbar navbar-inverse navbar-fixed-top">
     <div class="navbar-inner">
       <div class="container">
         <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
         </button>
         <a class="brand" href="./index.html">Smll framework</a>
         <div class="nav-collapse collapse">
           <ul class="nav">
             <li class="">
               <a href="./index.html">Home</a>
             </li>
             <li class="active">
               <a href="./getting-started.html">Get started</a>
             </li>
             <li class="">
               <a href="./road-map.html">Road map</a>
             </li>
             <li class="">
               <a href="./feedback.html">Feed back</a>
             </li>
           </ul>
         </div>
       </div>
     </div>
  </div>
  <div class="container" id="main-wrapper">
    <div class="row">
      <div class="span12">
        <div class="well">
       <h1>Introducing Smll MVC</h1>
       <p>Looking for a effective and easy to use PHP MVC framework? This is it!</p>
       
       <section id="downloads" class="">
           <a href="https://github.com/madebykrol/Smll/zipball/master" class="btn btn-inverse">Download as .zip</a>
           <a href="https://github.com/madebykrol/Smll/tarball/master" class="btn btn-inverse">Download as .tar.gz</a>
           <a href="https://github.com/madebykrol/Smll" class="btn btn-github btn-inverse"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
      </div>
    </div>
    <div class="row">
     <div class="span12"><div class="pull-left"><a class="btn" href="./getting-started-a-guestbook.html">Back</a></div><div class="pull-right"></div></div> 
    </div>
    <div class="row">
      <div class="span9">
        <h1>Handelling post</h1>
        <p>By convention Smll is posting the form to an action prefixed with <span class="label">post_</span>
        So we are going to create a new Action in our HomeController called <span class="label">post_index</span></p>
<pre class="prettyprint lang-php linenums">
public function post_index(GuestbookFormModel $model) {  
	if($this->modelState->isValid()) {
	  try {
	  
	    $this->db->insert('guestbook',
	        array(
	            'name'  => $model->name,
	            'message'     => $model->message));
	  
	  } catch(Exception $e) {
	    print $e->getMessage();
	  }
	  $model = new GuestbookFormModel();
	}
	
	return $this->View($model);
}
</pre>
      <h3>Connect to a database</h3>
      <p>Add the following code to your HomeController.</p>
<pre class="prettyprint lang-php linenums">
private $db = null;
  
public function __construct() {
    // A connectionstring
    $this->db = new DB("Driver=MySQL;Server=localhost;Database=smll_example;User=user;Password=password");
}
</pre>
      <p>
        
      </p>
      <p>
        There is alot of magic going on in the background here in your <span class="label">post_index</span> that I will try to explain.
      </p>
      <ul class="nav nav-list">
        <li>
       
        </li>
        <li>
        <strong>Line 1 </strong>
        <p>Smll's default <span class="label">ModelBinder</span> is responsible for mapping the posted data to your action into your model!</p>
        </li>
        <li>
        <strong>Line 2 </strong>
        <p>Checking the current model state.</p>
        </li>
        <li>
        <strong>Line 5 - 8 </strong>
        <p>Persist our guestbook post</p>
        </li>
        <li>
        <strong>Line 13 </strong>
        <p>Clear the model</p>
        </li>
        <li>
        <strong>Line 16 </strong>
        <p>Return the model in the view</p>
        </li>
      </ul>
      <h2>Displaying entries in our guestbook.</h2>
      <p>
        create a new action called entries
      </p>
<pre class="prettyprint lang-php linenums">
public function entries() {
  $result = null;
  if($this->db->get('guestbook')) {
    $result = $this->db->getResult();
  }
  
  return $this->view($result);
}
</pre>
      <p>
        Create a view for our action in the views/Home/ folder called <span class="label">entries.phtml</span>
      </p>
<pre class="prettyprint lang-html linenums">
&lt;h2&gt;Guestbook Entries&lt;/h2&gt;
&lt;ul&gt;
&lt;?php 
  foreach($model as $entry) {
    ?&gt;
    &lt;li&gt;
    &lt;p&gt;
      &lt;?php print $entry->message;?&gt;
    &lt;/p&gt;
    &lt;strong&gt;&lt;?php print $entry-&gt;firstname;?&gt;&lt;/strong&gt;
    &lt;/li&gt;
    &lt;?php 
  }
?&gt;
&lt;/ul&gt;
</pre>
<h2>Final step.</h2>
<h3>Render entries on our index page.</h3>
<p>
Alter your <span class="label">views/Home/index.phtml</span> with the following line
</p>
<pre class="prettyprint html-php linenums">
&lt;?php print Html::renderAction('entries', 'Home'); ?&gt;
</pre>
<h2>Summary</h2>
<p>
We have now created one really basic Smll MVC application which uses quite alot of Smlls MVC
functions.

There are some improvements we can do thou. for instance, take a look at <span class="label">internal redirects</span> and
<span class="label">validation annotations</span>
</p>
      </div>
    </div>
    <div class="row">
     <div class="span12"><div class="pull-left"><a class="btn" href="./getting-started-a-guestbook.html">Back</a></div><div class="pull-right"></div></div> 
    </div>
  </div>
<footer class="footer">
  <div class="container">
    <p>Developed with love and passion for software design and architecture by Kristoffer "<a href="http://twitter.com/madebykrol">mbk</a>" Olsson as a open source project </p>
    <p>"I Love to write code, and I love the idea of sharing software, thats why I decided to release this project for free"</p>
    <p><a href="./license.html">license</a></p>
  </div>
</footer>
<script src="./scripts/jquery.js"></script>
<script src="./scripts/bootstrap/js/bootstrap.js"></script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37201377-2', 'madebykrol.github.io');
  ga('send', 'pageview');

</script>
</body>
</html>
